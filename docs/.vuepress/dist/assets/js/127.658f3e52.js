(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{571:function(a,e,s){"use strict";s.r(e);var t=s(21),r=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"一、什么是lua"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、什么是lua"}},[a._v("#")]),a._v(" 一、什么是lua ?")]),a._v(" "),s("p",[a._v("Lua 是一个简洁、轻量、可扩展的脚本语言，它的特性有：")]),a._v(" "),s("ul",[s("li",[a._v("轻量：源码包只有核心库，编译后体积很小。")]),a._v(" "),s("li",[a._v("高效：由C 编写的，启动快、运行快。")]),a._v(" "),s("li",[a._v("内嵌：可内嵌到各种编程语言或系统中运行，提升静态语言的灵活性。\n而且完全不需要担心语法问题，Lua 的语法很简单，分分钟使用不成问题。")])]),a._v(" "),s("h3",{attrs:{id:"二、redis-为什么要使用lua"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、redis-为什么要使用lua"}},[a._v("#")]),a._v(" 二、Redis 为什么要使用LUA ？")]),a._v(" "),s("ol",[s("li",[a._v("原子性：将redis的多个操作合成一个脚本，然后整体执行，在脚本的执行中，不会出现资源竞争的情况。")]),a._v(" "),s("li",[a._v("减少网络通信：把多个命令合成一个lua脚本，redis统一执行脚本。")]),a._v(" "),s("li",[a._v("复用性：client发送的脚本会永久存储在redis中，这意味着其他客户端可以复用这一脚本来完成同样的逻辑。")])]),a._v(" "),s("h3",{attrs:{id:"三、lua的语法入门"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、lua的语法入门"}},[a._v("#")]),a._v(" 三、lua的语法入门")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("EVAL script numkeys key [key ...] arg [arg ...]\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("script： 参数是一段 Lua脚本程序。脚本不必(也不应该)定义为一个Lua函数。\nnumkeys： 用于指定key参数的个数。\nkey [key ...]： 代表redis的key,从 EVAL 的第三个参数开始算起，表示在脚本中所用到的Redis键(key)。\n在Lua中，这些键名参数可以通过全局变量 KEYS 数组，用1为基址的形式访问( KEYS[1] ，KEYS[2]，依次类推)。"),s("br"),a._v("\narg [arg ...]： 代表lua的入参，在Lua中通过全局变量ARGV数组访问，访问的形式和KEYS变量类似( ARGV[1] 、 ARGV[2] ，诸如此类)。"),s("br"),a._v("\n特别注意：lua的数组坐标不是从0开始，是从1开始。从1开始！从1开始！从1开始！\n入门例子")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('127.0.0.1:6379> EVAL  "return {KEYS[1],KEYS[2],ARGV[1],ARGV[2]}" 2  key1 key2 zhoubiao1 zhoubiao2\n1) "key1"\n2) "key2"\n3) "zhoubiao1"\n4) "zhoubiao2"\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[a._v("对以上脚本的详细说明：")]),a._v(" "),s("ol",[s("li",[a._v("eval为rendis的关键字")]),a._v(" "),s("li",[a._v("双引号的内容代表lua脚本")]),a._v(" "),s("li",[a._v("2代表numkeys参数的个数，即有多少个key")]),a._v(" "),s("li",[a._v("key1 和 key2代表 KEYS[1],KEYS[2]的入参")]),a._v(" "),s("li",[a._v("zhoubiao1 zhoubiao2 是ARGV[1],ARGV[2]的入参")])])])}),[],!1,null,null,null);e.default=r.exports}}]);